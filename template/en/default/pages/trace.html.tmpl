[%#
  # The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla TraceParser Plugin.
  #
  # The Initial Developer of the Original Code is Canonical Ltd.
  # Portions created by Canonical Ltd. are Copyright (C) 2009
  # Canonical Ltd. All Rights Reserved.
  #
  # Contributor(s):
  #   Max Kanat-Alexander <mkanat@bugzilla.org>
  #%]

[% PROCESS global/header.html.tmpl
   title = "Trace $trace.id From Bug $trace.bug.id" 
%]

[% IF identical_traces.size %]
  <p>Identical Traces:</p>
  [% PROCESS trace_list list = identical_traces %]
[% END %]

[% IF similar_traces.size %]
  <p>Similar Traces:</p>
  [% PROCESS trace_list list = similar_traces %]
[% END %]

<table border="0" cellpadding="0" cellspacing="0"><tr><td><div class="trace">
<pre>[% trace.text FILTER html %]
</pre></div></td></tr></table>

[% PROCESS global/footer.html.tmpl %]

[% BLOCK trace_list %]
  <ul class="trace_list">
    [% FOREACH this_trace = list %]
      [% SET bug = this_trace.bug %]
      <li>
        <a href="page.cgi?id=trace.html&amp;trace_id=
                 [%- this_trace.id FILTER url_quote %]">Trace 
          [% this_trace.id FILTER html %]</a> on
        [%+ "Bug $bug.id" FILTER bug_link(bug.id) %]
        (Quality: [% this_trace.quality FILTER html %])
        [% IF user.can_see_bug(bug) %]
          [%+ bug.product FILTER html %]
        [% END %]
      </li>
    [% END %]
  </ul>
[% END %]
